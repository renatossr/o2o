<h1>Faturas</h1>

<table class="table table-hover mt-3" data-controller="masks" id="members">
  <thead class="table-dark">
    <tr>
      <th></th>
      <th>ID</th>
      <th>Aluno</th>
      <th>Data</th>
      <th>Status</th>
      <th>Valor Total</th>
    </tr>
  </thead>
  <tbody>
    <% @invoices.each do |invoice| %>
    <tr id="<%= dom_id invoice %>">
      <td><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#<%= dom_id invoice %>_items" aria-expanded="false" aria-controls="<%= dom_id invoice %>_items"><i class="bi bi-plus"></i></button></td>
      <td><%= invoice.id %></td>
      <td><%= invoice.member.name %></td>
      <td><%= invoice.reference_date %></td>
      <td><%= invoice.status %></td>
      <td><span>R$ </span><span data-masks-target="money"><%= invoice.total_value_cents %></span></td>
    </tr>
    <tr>
      <td colspan="6" class="py-0">
        <div id="<%= dom_id invoice %>_items" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#<%= dom_id invoice %>"> 
        <table class="table table-striped">
          <thead>
            <tr class="info">
              <th></th>
              <th></th>
              <th>Descrição</th>
              <th>Valor</th>
            </tr>
          </thead>	
          
          <tbody>
            <% invoice.billing_items.each do |item| %>
            <tr>
              <td></td>
              <td></td>
              <td><%= item.description %></td>
              <td><span>R$ </span><span data-masks-target="money"><%= item.total_cents %></span></td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </td>
    </tr>
    <% end %>
  </tbody>
</table>
